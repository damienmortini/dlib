<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>element-timeline</title>
  <style>
    html,
    body {
      width: 100%;
      height: 100%;
      margin: 0;
      font-family: sans-serif;
    }

    body {
      display: grid;
      justify-content: center;
      align-content: center;
    }

    element-timeline {
      width: 500px;
    }

    details {
      box-sizing: border-box;
      border: 1px dashed lightgrey;
      width: 500px;
      overflow: hidden;
    }

    details[open] {
      height: 200px
    }
  </style>
</head>

<body>
  <element-timeline duration="60" zoom="6">
    <damo-input-signal-array name="tree" step=".5" max="1" frequency="100">
    </damo-input-signal-array>
    <damo-input-signal-array name="rock" array="1, 2, 4, 6, 3, 6, 3, 4, 7, 5, 4, 3, 3, 4, 2, 3, 4, 2">
    </damo-input-signal-array>
    <damo-input-signal-array name="sky" array="1, 2, 4, 6, 3, 6, 3, 4, 7, 5, 4, 3, 3, 4, 2, 3, 4, 2">
    </damo-input-signal-array>
  </element-timeline>
  <details open>
    <summary>Output</summary>
    <div id="output"></div>
  </details>

  <script type="module">
    import '../../element-input-signal-array/index.js';
    import Element from '../index.js';

    window.customElements.define(`element-timeline`, Element);

    const timelineElement = document.querySelector('element-timeline');
    // const output = document.querySelector('#output');
    // const channelNames = ['Rock1', 'Rock2', 'Rock3', 'Light1', 'Light2', 'Light3', 'Sky', 'Tree1', 'Tree2', 'Player'];
    // const keys = ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'];
    // for (const [index, name] of channelNames.entries()) {
    //   const keyframes = new Set();
    //   const step = .5;
    //   for (let index = 0; index < 40; index++) {
    //     keyframes.add(Math.floor(Math.random() * 1000) * step);
    //   }
    //   timelineElement.addChannel({
    //     name,
    //     key: keys[index],
    //     color: `rgb(${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)})`,
    //     keyframes,
    //     step,
    //   });
    // }
    const outputDivs = [];
    for (let index = 0; index < 10; index++) {
      const div = document.createElement('div');
      outputDivs.push(div);
      output.prepend(div);
    }
    timelineElement.addEventListener('change', (event) => {
      const div = outputDivs.shift();
      outputDivs.push(div);
      // div.style.color = event.detail.color;
      div.textContent = `${event.target.name} @ ${event.target.value}`;
      output.prepend(div);
    });
    // timelineElement.addEventListener('change', (event) => {
    //   console.log(event.target.name, event.target.value);
    // });
    // timelineElement.addEventListener('input', (event) => {
    //   console.log(event.target.name, event.target.value);
    // });
    window.addEventListener('keydown', (event) => {
      if (event.key === ' ') {
        timelineElement[timelineElement.paused ? 'play' : 'pause']();
      }
    });
  </script>
</body>

</html>